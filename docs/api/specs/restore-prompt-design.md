# Restoration Prompt Design Specification

## Purpose

This specification defines how to create a `API-RESTORATION-PROMPT.md` file that can cleanly remove all generated project artifacts and restore the package to its pre-implementation state (ready for the implementation-prompt to run again).

## Core Principle

The restoration prompt is a **mirror operation** of the implementation prompt:
- **Implementation**: Read specs → Generate code, config, docs → Create restoration prompt
- **Restoration**: Delete generated files → Verify pre-implementation state remains

## Scope of Restoration

### Files/Directories to DELETE
These are generated by the implementation prompt and should be removed:

**Source Code**:
- `/src/` directory (entire directory)
- `/tests/` directory (entire directory)

**Configuration & Build**:
- `/global.json` (SDK version lock)
- `/hello-world-api.sln` (solution file)
- `/.gitignore` (.NET ignore rules)

**Generated Documentation**:
- `/docs/api/guides/getting-started.md` (generated guide only)

**Build Artifacts** (optional - can be cleaned separately):
- `/src/api/bin/` (build output)
- `/src/api/obj/` (intermediate objects)
- `/tests/api/bin/` (test output)
- `/tests/api/obj/` (test intermediate objects)

### Files/Directories to PRESERVE
These are specifications and should remain:

**Core Specifications**:
- `/docs/api/specs/hello-endpoint.md`
- `/docs/api/specs/api-design.md`
- `/docs/api/specs/error-handling.md`
- `/docs/api/specs/technology-choices.md`
- `/docs/api/specs/getting-started-design.md`

**Guides & Architecture**:
- `/docs/api/guides/adding-endpoints.md`
- `/docs/api/adr/adr-001-minimal-apis.md`

**Project Guidance**:
- `CLAUDE.md`
- `README.md`
- `API-IMPLEMENTATION-PROMPT.md`

## Restoration Prompt Structure

The `API-RESTORATION-PROMPT.md` file should have this structure:

### Section 1: Purpose
- Clearly state that this removes all generated artifacts
- Explain that this restores the package to pre-implementation state
- Warn that this is irreversible (but safe, since generated files can be recreated)

### Section 2: Verification
- Verify that the package is in a valid state before deletion
- Check for required specification files
- Ensure nothing critical is missing

### Section 3: Deletion Steps
- Delete each category of files/directories with clear instructions
- Provide commands to verify deletion (file not found is success)
- Include batch deletion commands for efficiency

### Section 4: Post-Restoration Verification
- Verify all specification files remain intact
- Verify all generated files are gone
- List files that should exist (specs)
- List files that should NOT exist (generated)

### Section 5: Next Steps
- Explain that package is now ready for implementation-prompt to run again
- Reference the API-IMPLEMENTATION-PROMPT.md
- Suggest checking specifications if something is wrong

### Section 6: Self-Deletion
- **CRITICAL**: Include instruction to delete the API-RESTORATION-PROMPT.md file itself
- This ensures the package returns to exact pre-implementation state
- Provide the command to do this safely

## Content Principles

### What to Include
- Clear, safe deletion instructions
- Verification steps to confirm deletions
- Explanations of why each file is being deleted
- Error handling for missing files (expected, not an error)
- References to specification files that should remain
- Instructions for self-deletion

### What NOT to Include
- Code or implementation details
- Assumptions about project state
- Dangerous commands (use safe deletion, not force delete)
- Partial deletion strategies

## Safety Considerations

### Safe Deletion Practices
- Verify file existence before deletion (don't fail on missing files)
- Use directory-level deletion carefully
- Provide before/after verification
- Include "undo" information (point to implementation-prompt to recreate)

### Error Handling
- If a specification file is missing, warn but continue (data loss prevention)
- If a generated file is missing, this is OK (may have been deleted already)
- Provide clear error messages if something unexpected happens

### User Confirmation
- The prompt should ask for confirmation before destructive operations
- OR clearly warn that this is irreversible
- Provide a "dry run" option (list what would be deleted without deleting)

## Integration with Implementation Prompt

The `API-RESTORATION-PROMPT.md` should be created as the **final step** of `API-IMPLEMENTATION-PROMPT.md`:

### API-IMPLEMENTATION-PROMPT.md Final Section
```
## Part 4: Create Restoration Prompt (Final Step)

After generating getting-started.md:

1. Review [Restoration Prompt Design Specification](./docs/api/specs/restore-prompt-design.md)
2. Generate `/API-RESTORATION-PROMPT.md` with:
   - Clear purpose: reversing the implementation
   - Verification steps to confirm file deletions
   - Safe deletion commands for all generated artifacts
   - Preservation of all specification files
   - Post-restoration verification checklist
   - Self-deletion instruction as final step

The generated restoration prompt can later be executed to cleanly remove
all generated project artifacts and restore the package to pre-implementation state.
```

## Relationship to Specifications

This file is referenced by:
- `API-IMPLEMENTATION-PROMPT.md` → Final generation step (Part 4)
- `API-RESTORATION-PROMPT.md` → Uses this design as template (generated)

## File Metadata

- **Filename**: `restore-prompt-design.md`
- **Location**: `/docs/api/specs/`
- **Purpose**: Template for generating API-RESTORATION-PROMPT.md
- **Status**: Specification (exists before implementation)
- **Self-Referential**: Used to generate API-RESTORATION-PROMPT.md which references this file
